<!DOCTYPE html>

<head> </head>

<body>
  <div>
    <p id="status">Validating app...</p>
  </div>
</body>

<script src="./getParams.js"></script>

<script>
  // Get URL parameters
  const { code, appId, isOrg } = getParams(window.location.href);

  const ORG_ENDPOINT = `https://github.com/organizations/${orgName}/settings/apps`;
  const PERSONAL_ENDPOINT = `https://github.com/settings/apps`;

  var xhr = new XMLHttpRequest();
  xhr.open('POST', `https://api.github.com/app-manifests/${code}/conversions`, true);
  xhr.send();

  xhr.onreadystatechange = () => {
    console.log('onreadystatechange');
    console.log(xhr);
    if (xhr.readyState == 4) window.location.replace(isOrg ? ORG_ENDPOINT : PERSONAL_ENDPOINT);
  };
</script>
